<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>🧠 Image ➜ Prompt | مهندس محمد حماد</title>
<style>
body{background:#0f1115;color:#e9eef3;font-family:sans-serif;display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;padding:0}
.container{background:#151923;padding:30px;border-radius:20px;max-width:800px;width:90%;box-shadow:0 0 20px rgba(0,0,0,0.4)}
h1{text-align:center;color:#00e0a4;margin-bottom:20px}
input[type=file]{display:none}
label{display:block;text-align:center;background:#00e0a4;color:#000;font-weight:bold;padding:14px;border-radius:10px;cursor:pointer;margin-bottom:20px;transition:.3s}
label:hover{background:#1df5b7}
img{max-width:100%;border-radius:10px;margin-bottom:20px}
textarea{width:100%;min-height:200px;padding:15px;border-radius:10px;border:none;resize:vertical;background:#1e212b;color:#e9eef3;font-family:monospace}
button{margin-top:10px;padding:12px 20px;border:none;border-radius:8px;background:#00e0a4;color:#000;font-weight:bold;cursor:pointer;transition:.3s}
button:hover{background:#1df5b7}
.hidden{display:none}
footer{text-align:center;margin-top:15px;font-size:13px;color:#999}
footer a{color:#00e0a4;text-decoration:none;font-weight:bold}
footer a:hover{text-decoration:underline}
</style>
</head>
<body>
<div class="container">
  <h1>🖼️ Image ➜ Prompt</h1>
  <input type="file" id="imageInput" accept="image/*">
  <label for="imageInput">📤 اختر صورة للتحليل</label>
  <div id="previewContainer" class="hidden"><img id="preview" src=""></div>
  <textarea id="promptOutput" placeholder="سيظهر هنا الوصف الناتج عن الذكاء الاصطناعي..."></textarea>
  <button onclick="copyPrompt()">📋 نسخ البرومبت</button>
  <footer>من برمجة وملك <a href="https://www.facebook.com/en.mohamed.nasr" target="_blank">المهندس محمد حماد</a></footer>
</div>

<script>
const proxy = "https://corsproxy.io/?";
const hfURL = "https://hf.space/embed/Salesforce/BLIP2/+/api/predict/";

async function analyzeImage(base64){
  const response = await fetch(proxy + encodeURIComponent(hfURL), {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({"data":["data:image/jpeg;base64," + base64]})
  });
  const data = await response.json();
  if (data?.data?.length > 0) return data.data[0];
  return "❌ لم يتمكن النظام من توليد وصف، حاول بعد لحظات.";
}

document.getElementById('imageInput').addEventListener('change', e=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = async ev => {
    const base64 = ev.target.result.split(',')[1];
    document.getElementById('preview').src = ev.target.result;
    document.getElementById('previewContainer').classList.remove('hidden');
    const out = document.getElementById('promptOutput');
    out.value = "⏳ جاري التحليل عبر الإنترنت...";
    try {
      const result = await analyzeImage(base64);
      out.value = result;
    } catch(err) {
      out.value = "❌ حدث خطأ أثناء التحليل.\n" + err;
      console.error(err);
    }
  };
  reader.readAsDataURL(file);
});

function copyPrompt(){
  const txt = document.getElementById('promptOutput');
  txt.select();
  document.execCommand('copy');
  alert("✅ تم نسخ البرومبت!");
}
</script>
</body>
</html>
